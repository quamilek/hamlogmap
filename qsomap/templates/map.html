{% extends 'base.html' %}

{% block title %}Mapa OpenStreetMap{% endblock %}

{% block head %}
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js"></script>
    <style>
        #map { height: 500px; }
    </style>
{% endblock %}

{% block content %}
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Mapa OpenStreetMap</h5>
                    <div id="map"></div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script>
        var map = L.map('map').setView([0, 0], 2);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Lokalizacje
        var poznan = L.marker([52.4064, 16.9252], { icon: L.AwesomeMarkers.icon({ icon: 'fa-star', markerColor: 'red', shape: 'circle', prefix: 'fa' }) }).addTo(map).bindPopup('Poznań');
        var sydney = L.marker([-33.8688, 151.2093], { icon: L.AwesomeMarkers.icon({ icon: 'fa-star', markerColor: 'red', shape: 'circle', prefix: 'fa' }) }).addTo(map).bindPopup('Sydney');
        var alaska = L.marker([64.8561, -147.7534], { icon: L.AwesomeMarkers.icon({ icon: 'fa-star', markerColor: 'red', shape: 'circle', prefix: 'fa' }) }).addTo(map).bindPopup('Alaska');
        var santiago = L.marker([-33.4489, -70.6693], { icon: L.AwesomeMarkers.icon({ icon: 'fa-star', markerColor: 'red', shape: 'circle', prefix: 'fa' }) }).addTo(map).bindPopup('Santiago');
        var tokyo = L.marker([35.6762, 139.6503], { icon: L.AwesomeMarkers.icon({ icon: 'fa-star', markerColor: 'red', shape: 'circle', prefix: 'fa' }) }).addTo(map).bindPopup('Tokio');

        // Rysowanie linii między Poznaniem a Sydney
        var pointsPoznanSydney = [];
        for (var i = 0; i <= 100; i++) {
            var t = i / 100;
            var lat1 = 52.4064 * Math.PI / 180;
            var lng1 = 16.9252 * Math.PI / 180;
            var lat2 = -33.8688 * Math.PI / 180;
            var lng2 = 151.2093 * Math.PI / 180;
            var d = 2 * Math.asin(Math.sqrt(Math.pow(Math.sin((lat2 - lat1) / 2), 2) + Math.cos(lat1) * Math.cos(lat2) * Math.pow(Math.sin((lng2 - lng1) / 2), 2)));
            var A = Math.sin((1 - t) * d) / Math.sin(d);
            var B = Math.sin(t * d) / Math.sin(d);
            var x = A * Math.cos(lat1) * Math.cos(lng1) + B * Math.cos(lat2) * Math.cos(lng2);
            var y = A * Math.cos(lat1) * Math.sin(lng1) + B * Math.cos(lat2) * Math.sin(lng2);
            var z = A * Math.sin(lat1) + B * Math.sin(lat2);
            var lat = Math.atan2(z, Math.sqrt(x * x + y * y)) * 180 / Math.PI;
            var lng = Math.atan2(y, x) * 180 / Math.PI;
            pointsPoznanSydney.push([lat, lng]);
        }
        var linePoznanSydney = L.polyline(pointsPoznanSydney, { color: 'red', weight: 2 }).addTo(map);

        // Rysowanie linii między Poznaniem a Alaską
        var pointsPoznanAlaska = [];
        for (var i = 0; i <= 100; i++) {
            var t = i / 100;
            var lat1 = 52.4064 * Math.PI / 180;
            var lng1 = 16.9252 * Math.PI / 180;
            var lat2 = 64.8561 * Math.PI / 180;
            var lng2 = -147.7534 * Math.PI / 180;
            var d = 2 * Math.asin(Math.sqrt(Math.pow(Math.sin((lat2 - lat1) / 2), 2) + Math.cos(lat1) * Math.cos(lat2) * Math.pow(Math.sin((lng2 - lng1) / 2), 2)));
            var A = Math.sin((1 - t) * d) / Math.sin(d);
            var B = Math.sin(t * d) / Math.sin(d);
            var x = A * Math.cos(lat1) * Math.cos(lng1) + B * Math.cos(lat2) * Math.cos(lng2);
            var y = A * Math.cos(lat1) * Math.sin(lng1) + B * Math.cos(lat2) * Math.sin(lng2);
            var z = A * Math.sin(lat1) + B * Math.sin(lat2);
            var lat = Math.atan2(z, Math.sqrt(x * x + y * y)) * 180 / Math.PI;
            var lng = Math.atan2(y, x) * 180 / Math.PI;
            pointsPoznanAlaska.push([lat, lng]);
        }
        var linePoznanAlaska = L.polyline(pointsPoznanAlaska, { color: 'blue', weight: 2 }).addTo(map);

        // Rysowanie linii między Poznaniem a Santiago
        var pointsPoznanSantiago = [];
        for (var i = 0; i <= 100; i++) {
            var t = i / 100;
            var lat1 = 52.4064 * Math.PI / 180;
            var lng1 = 16.9252 * Math.PI / 180;
            var lat2 = -33.4489 * Math.PI / 180;
            var lng2 = -70.6693 * Math.PI / 180;
            var d = 2 * Math.asin(Math.sqrt(Math.pow(Math.sin((lat2 - lat1) / 2), 2) + Math.cos(lat1) * Math.cos(lat2) * Math.pow(Math.sin((lng2 - lng1) / 2), 2)));
            var A = Math.sin((1 - t) * d) / Math.sin(d);
            var B = Math.sin(t * d) / Math.sin(d);
            var x = A * Math.cos(lat1) * Math.cos(lng1) + B * Math.cos(lat2) * Math.cos(lng2);
            var y = A * Math.cos(lat1) * Math.sin(lng1) + B * Math.cos(lat2) * Math.sin(lng2);
            var z = A * Math.sin(lat1) + B * Math.sin(lat2);
            var lat = Math.atan2(z, Math.sqrt(x * x + y * y)) * 180 / Math.PI;
            var lng = Math.atan2(y, x) * 180 / Math.PI;
            pointsPoznanSantiago.push([lat, lng]);
        }
        var linePoznanSantiago = L.polyline(pointsPoznanSantiago, { color: 'green', weight: 2 }).addTo(map);

        // Rysowanie linii między Poznaniem a Tokio
        var pointsPoznanTokyo = [];
        for (var i = 0; i <= 100; i++) {
            var t = i / 100;
            var lat1 = 52.4064 * Math.PI / 180;
            var lng1 = 16.9252 * Math.PI / 180;
            var lat2 = 35.6762 * Math.PI / 180;
            var lng2 = 139.6503 * Math.PI / 180;
            var d = 2 * Math.asin(Math.sqrt(Math.pow(Math.sin((lat2 - lat1) / 2), 2) + Math.cos(lat1) * Math.cos(lat2) * Math.pow(Math.sin((lng2 - lng1) / 2), 2)));
            var A = Math.sin((1 - t) * d) / Math.sin(d);
            var B = Math.sin(t * d) / Math.sin(d);
            var x = A * Math.cos(lat1) * Math.cos(lng1) + B * Math.cos(lat2) * Math.cos(lng2);
            var y = A * Math.cos(lat1) * Math.sin(lng1) + B * Math.cos(lat2) * Math.sin(lng2);
            var z = A * Math.sin(lat1) + B * Math.sin(lat2);
            var lat = Math.atan2(z, Math.sqrt(x * x + y * y)) * 180 / Math.PI;
            var lng = Math.atan2(y, x) * 180 / Math.PI;
            pointsPoznanTokyo.push([lat, lng]);
        }
        var linePoznanTokyo = L.polyline(pointsPoznanTokyo, { color: 'purple', weight: 2 }).addTo(map);
    </script>
{% endblock %} 